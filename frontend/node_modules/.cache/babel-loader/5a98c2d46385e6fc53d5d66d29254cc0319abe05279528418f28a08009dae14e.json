{"ast":null,"code":"import{useEffect}from'react';import{Navigate,useLocation}from'react-router-dom';import{motion}from'framer-motion';import{useAuth}from'../../contexts/AuthContext';import LoadingSpinner from'../ui/LoadingSpinner';import toast from'react-hot-toast';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const ProtectedRoute=_ref=>{let{children,requiredRoles=[],requiredPermissions=[]}=_ref;const{isAuthenticated,isLoading,user,hasAnyRole,hasAnyPermission}=useAuth();const location=useLocation();// Show login required message when accessing protected routes without authentication\nuseEffect(()=>{if(!isLoading&&!isAuthenticated){toast.error('Login required to access this feature.',{duration:4000,icon:'ðŸ”’',style:{background:'#ef4444',color:'#fff'}});}},[isLoading,isAuthenticated]);// Show loading spinner while checking authentication\nif(isLoading){return/*#__PURE__*/_jsx(\"div\",{className:\"min-h-screen flex items-center justify-center bg-gray-50\",children:/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,scale:0.9},animate:{opacity:1,scale:1},transition:{duration:0.3},className:\"text-center\",children:[/*#__PURE__*/_jsx(LoadingSpinner,{size:\"lg\"}),/*#__PURE__*/_jsx(\"p\",{className:\"mt-4 text-gray-600\",children:\"Verifying authentication...\"})]})});}// Redirect to login if not authenticated\nif(!isAuthenticated){// Save the attempted location for redirect after login\nreturn/*#__PURE__*/_jsx(Navigate,{to:\"/login\",state:{from:location.pathname},replace:true});}// Check role requirements\nif(requiredRoles.length>0){const hasRequiredRole=hasAnyRole(requiredRoles);if(!hasRequiredRole){return/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:0.3},className:\"min-h-screen flex items-center justify-center bg-gray-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-md w-full bg-white rounded-lg shadow-md p-8 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-error-100 rounded-full flex items-center justify-center mx-auto mb-4\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-8 h-8 text-error-600\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z\"})})}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-900 mb-2\",children:\"Access Denied\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 mb-6\",children:[\"You don't have the required role to access this page.\",requiredRoles.length===1?\" Required role: \".concat(requiredRoles[0]):\" Required roles: \".concat(requiredRoles.join(', '))]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500 mb-4\",children:[\"Your current role: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:user===null||user===void 0?void 0:user.role})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.history.back(),className:\"btn-primary\",children:\"Go Back\"})]})});}}// Check permission requirements\nif(requiredPermissions.length>0){const hasRequiredPermission=hasAnyPermission(requiredPermissions);if(!hasRequiredPermission){return/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:0.3},className:\"min-h-screen flex items-center justify-center bg-gray-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-md w-full bg-white rounded-lg shadow-md p-8 text-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-16 h-16 bg-warning-100 rounded-full flex items-center justify-center mx-auto mb-4\",children:/*#__PURE__*/_jsx(\"svg\",{className:\"w-8 h-8 text-warning-600\",fill:\"none\",stroke:\"currentColor\",viewBox:\"0 0 24 24\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z\"})})}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-2xl font-bold text-gray-900 mb-2\",children:\"Permission Required\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-600 mb-6\",children:[\"You don't have the required permissions to access this page.\",requiredPermissions.length===1?\" Required permission: \".concat(requiredPermissions[0]):\" Required permissions: \".concat(requiredPermissions.join(', '))]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-500 mb-4\",children:[\"Your role: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:user===null||user===void 0?void 0:user.role})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>window.history.back(),className:\"btn-primary\",children:\"Go Back\"})]})});}}// User is authenticated and has required roles/permissions\nreturn/*#__PURE__*/_jsx(_Fragment,{children:children});};export default ProtectedRoute;","map":{"version":3,"names":["useEffect","Navigate","useLocation","motion","useAuth","LoadingSpinner","toast","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ProtectedRoute","_ref","children","requiredRoles","requiredPermissions","isAuthenticated","isLoading","user","hasAnyRole","hasAnyPermission","location","error","duration","icon","style","background","color","className","div","initial","opacity","scale","animate","transition","size","to","state","from","pathname","replace","length","hasRequiredRole","y","fill","stroke","viewBox","strokeLinecap","strokeLinejoin","strokeWidth","d","concat","join","role","onClick","window","history","back","hasRequiredPermission"],"sources":["C:/Users/MSI/Videos/Employee-Register-App/frontend/src/components/auth/ProtectedRoute.tsx"],"sourcesContent":["import { useEffect, ReactNode } from 'react';\r\nimport { Navigate, useLocation } from 'react-router-dom';\r\nimport { motion } from 'framer-motion';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport LoadingSpinner from '../ui/LoadingSpinner';\r\nimport toast from 'react-hot-toast';\r\n\r\ninterface ProtectedRouteProps {\r\n  children: ReactNode;\r\n  requiredRoles?: string[];\r\n  requiredPermissions?: string[];\r\n}\r\n\r\nconst ProtectedRoute: React.FC<ProtectedRouteProps> = ({ \r\n  children, \r\n  requiredRoles = [], \r\n  requiredPermissions = [] \r\n}) => {\r\n  const { isAuthenticated, isLoading, user, hasAnyRole, hasAnyPermission } = useAuth();\r\n  const location = useLocation();\r\n\r\n  // Show login required message when accessing protected routes without authentication\r\n  useEffect(() => {\r\n    if (!isLoading && !isAuthenticated) {\r\n      toast.error('Login required to access this feature.', {\r\n        duration: 4000,\r\n        icon: 'ðŸ”’',\r\n        style: {\r\n          background: '#ef4444',\r\n          color: '#fff',\r\n        },\r\n      });\r\n    }\r\n  }, [isLoading, isAuthenticated]);\r\n\r\n  // Show loading spinner while checking authentication\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\r\n        <motion.div\r\n          initial={{ opacity: 0, scale: 0.9 }}\r\n          animate={{ opacity: 1, scale: 1 }}\r\n          transition={{ duration: 0.3 }}\r\n          className=\"text-center\"\r\n        >\r\n          <LoadingSpinner size=\"lg\" />\r\n          <p className=\"mt-4 text-gray-600\">Verifying authentication...</p>\r\n        </motion.div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Redirect to login if not authenticated\r\n  if (!isAuthenticated) {\r\n    // Save the attempted location for redirect after login\r\n    return <Navigate to=\"/login\" state={{ from: location.pathname }} replace />;\r\n  }\r\n\r\n  // Check role requirements\r\n  if (requiredRoles.length > 0) {\r\n    const hasRequiredRole = hasAnyRole(requiredRoles);\r\n    if (!hasRequiredRole) {\r\n      return (\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ duration: 0.3 }}\r\n          className=\"min-h-screen flex items-center justify-center bg-gray-50\"\r\n        >\r\n          <div className=\"max-w-md w-full bg-white rounded-lg shadow-md p-8 text-center\">\r\n            <div className=\"w-16 h-16 bg-error-100 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n              <svg className=\"w-8 h-8 text-error-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z\" />\r\n              </svg>\r\n            </div>\r\n            <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">Access Denied</h2>\r\n            <p className=\"text-gray-600 mb-6\">\r\n              You don't have the required role to access this page.\r\n              {requiredRoles.length === 1 \r\n                ? ` Required role: ${requiredRoles[0]}`\r\n                : ` Required roles: ${requiredRoles.join(', ')}`\r\n              }\r\n            </p>\r\n            <p className=\"text-sm text-gray-500 mb-4\">\r\n              Your current role: <span className=\"font-medium\">{user?.role}</span>\r\n            </p>\r\n            <button\r\n              onClick={() => window.history.back()}\r\n              className=\"btn-primary\"\r\n            >\r\n              Go Back\r\n            </button>\r\n          </div>\r\n        </motion.div>\r\n      );\r\n    }\r\n  }\r\n\r\n  // Check permission requirements\r\n  if (requiredPermissions.length > 0) {\r\n    const hasRequiredPermission = hasAnyPermission(requiredPermissions);\r\n    if (!hasRequiredPermission) {\r\n      return (\r\n        <motion.div\r\n          initial={{ opacity: 0, y: 20 }}\r\n          animate={{ opacity: 1, y: 0 }}\r\n          transition={{ duration: 0.3 }}\r\n          className=\"min-h-screen flex items-center justify-center bg-gray-50\"\r\n        >\r\n          <div className=\"max-w-md w-full bg-white rounded-lg shadow-md p-8 text-center\">\r\n            <div className=\"w-16 h-16 bg-warning-100 rounded-full flex items-center justify-center mx-auto mb-4\">\r\n              <svg className=\"w-8 h-8 text-warning-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z\" />\r\n              </svg>\r\n            </div>\r\n            <h2 className=\"text-2xl font-bold text-gray-900 mb-2\">Permission Required</h2>\r\n            <p className=\"text-gray-600 mb-6\">\r\n              You don't have the required permissions to access this page.\r\n              {requiredPermissions.length === 1 \r\n                ? ` Required permission: ${requiredPermissions[0]}`\r\n                : ` Required permissions: ${requiredPermissions.join(', ')}`\r\n              }\r\n            </p>\r\n            <p className=\"text-sm text-gray-500 mb-4\">\r\n              Your role: <span className=\"font-medium\">{user?.role}</span>\r\n            </p>\r\n            <button\r\n              onClick={() => window.history.back()}\r\n              className=\"btn-primary\"\r\n            >\r\n              Go Back\r\n            </button>\r\n          </div>\r\n        </motion.div>\r\n      );\r\n    }\r\n  }\r\n\r\n  // User is authenticated and has required roles/permissions\r\n  return <>{children}</>;\r\n};\r\n\r\nexport default ProtectedRoute;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}