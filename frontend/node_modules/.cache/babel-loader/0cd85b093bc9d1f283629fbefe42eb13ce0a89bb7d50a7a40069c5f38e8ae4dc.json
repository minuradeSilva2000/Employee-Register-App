{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\MSI\\\\Videos\\\\Employee-Register-App\\\\frontend\\\\src\\\\contexts\\\\AuthContext.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n/**\r\n * AuthContext - TypeScript Conversion\r\n * \r\n * CHANGES MADE:\r\n * 1. Added proper TypeScript interfaces for state, actions, and context\r\n * 2. Typed all function parameters and return values\r\n * 3. Created AuthState interface for reducer state\r\n * 4. Created AuthAction union type for all possible actions\r\n * 5. Typed reducer function with proper action types\r\n * 6. Added proper typing for context value\r\n * 7. Converted all functions to use TypeScript types\r\n * 8. Added proper error typing\r\n * \r\n * NO BEHAVIORAL CHANGES - All logic preserved exactly as-is\r\n */\n\nimport React, { createContext, useContext, useReducer, useEffect } from 'react';\nimport { authAPI } from '../services/api';\nimport toast from 'react-hot-toast';\n\n// Extend Window interface for Google API\n\n// ==================== INTERFACES ====================\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n// ==================== ACTION TYPES ====================\n\nconst AUTH_ACTIONS = {\n  LOGIN_START: 'LOGIN_START',\n  LOGIN_SUCCESS: 'LOGIN_SUCCESS',\n  LOGIN_FAILURE: 'LOGIN_FAILURE',\n  LOGOUT: 'LOGOUT',\n  REFRESH_TOKEN_START: 'REFRESH_TOKEN_START',\n  REFRESH_TOKEN_SUCCESS: 'REFRESH_TOKEN_SUCCESS',\n  REFRESH_TOKEN_FAILURE: 'REFRESH_TOKEN_FAILURE',\n  LOAD_USER_START: 'LOAD_USER_START',\n  LOAD_USER_SUCCESS: 'LOAD_USER_SUCCESS',\n  LOAD_USER_FAILURE: 'LOAD_USER_FAILURE',\n  CLEAR_ERROR: 'CLEAR_ERROR',\n  UPDATE_USER: 'UPDATE_USER'\n};\n\n// Union type for all possible actions\n\n// ==================== INITIAL STATE ====================\n\nconst initialState = {\n  user: null,\n  isAuthenticated: false,\n  isLoading: true,\n  error: null,\n  permissions: []\n};\n\n// ==================== REDUCER ====================\n\nconst authReducer = (state, action) => {\n  switch (action.type) {\n    case AUTH_ACTIONS.LOGIN_START:\n      return {\n        ...state,\n        isLoading: true,\n        error: null\n      };\n    case AUTH_ACTIONS.LOGIN_SUCCESS:\n      return {\n        ...state,\n        user: action.payload.user,\n        isAuthenticated: true,\n        isLoading: false,\n        error: null,\n        permissions: action.payload.user.permissions || []\n      };\n    case AUTH_ACTIONS.LOGIN_FAILURE:\n      return {\n        ...state,\n        user: null,\n        isAuthenticated: false,\n        isLoading: false,\n        error: action.payload,\n        permissions: []\n      };\n    case AUTH_ACTIONS.LOGOUT:\n      return {\n        ...state,\n        user: null,\n        isAuthenticated: false,\n        isLoading: false,\n        error: null,\n        permissions: []\n      };\n    case AUTH_ACTIONS.REFRESH_TOKEN_START:\n      return {\n        ...state,\n        isLoading: true\n      };\n    case AUTH_ACTIONS.REFRESH_TOKEN_SUCCESS:\n      return {\n        ...state,\n        user: action.payload.user,\n        isAuthenticated: true,\n        isLoading: false,\n        error: null,\n        permissions: action.payload.user.permissions || []\n      };\n    case AUTH_ACTIONS.REFRESH_TOKEN_FAILURE:\n      return {\n        ...state,\n        user: null,\n        isAuthenticated: false,\n        isLoading: false,\n        error: action.payload,\n        permissions: []\n      };\n    case AUTH_ACTIONS.LOAD_USER_START:\n      return {\n        ...state,\n        isLoading: true\n      };\n    case AUTH_ACTIONS.LOAD_USER_SUCCESS:\n      return {\n        ...state,\n        user: action.payload.user,\n        isAuthenticated: true,\n        isLoading: false,\n        error: null,\n        permissions: action.payload.user.permissions || []\n      };\n    case AUTH_ACTIONS.LOAD_USER_FAILURE:\n      return {\n        ...state,\n        user: null,\n        isAuthenticated: false,\n        isLoading: false,\n        error: action.payload,\n        permissions: []\n      };\n    case AUTH_ACTIONS.CLEAR_ERROR:\n      return {\n        ...state,\n        error: null\n      };\n    case AUTH_ACTIONS.UPDATE_USER:\n      return {\n        ...state,\n        user: state.user ? {\n          ...state.user,\n          ...action.payload\n        } : null\n      };\n    default:\n      return state;\n  }\n};\n\n// ==================== CONTEXT ====================\n\nconst AuthContext = /*#__PURE__*/createContext(undefined);\n\n// ==================== PROVIDER ====================\n\nexport const AuthProvider = ({\n  children\n}) => {\n  _s();\n  const [state, dispatch] = useReducer(authReducer, initialState);\n\n  // Get tokens from localStorage\n  const getTokens = () => {\n    const accessToken = localStorage.getItem('accessToken');\n    const refreshToken = localStorage.getItem('refreshToken');\n    return {\n      accessToken,\n      refreshToken\n    };\n  };\n\n  // Set tokens to localStorage\n  const setTokens = (accessToken, refreshToken) => {\n    localStorage.setItem('accessToken', accessToken);\n    localStorage.setItem('refreshToken', refreshToken);\n  };\n\n  // Clear tokens from localStorage\n  const clearTokens = () => {\n    localStorage.removeItem('accessToken');\n    localStorage.removeItem('refreshToken');\n  };\n\n  // Set auth data (for OAuth callbacks)\n  const setAuthData = ({\n    user,\n    accessToken,\n    refreshToken\n  }) => {\n    setTokens(accessToken, refreshToken);\n    dispatch({\n      type: AUTH_ACTIONS.LOGIN_SUCCESS,\n      payload: {\n        user\n      }\n    });\n  };\n\n  // Google OAuth login\n  const loginWithGoogle = async googleData => {\n    try {\n      dispatch({\n        type: AUTH_ACTIONS.LOGIN_START\n      });\n\n      // Store access token in localStorage FIRST\n      if (googleData.accessToken) {\n        localStorage.setItem('accessToken', googleData.accessToken);\n      }\n\n      // Store refresh token if available\n      if (googleData.refreshToken) {\n        localStorage.setItem('refreshToken', googleData.refreshToken);\n      }\n\n      // Update state with user data AFTER tokens are stored\n      dispatch({\n        type: AUTH_ACTIONS.LOGIN_SUCCESS,\n        payload: {\n          user: googleData.user\n        }\n      });\n      console.log('‚úÖ Google login successful in AuthContext');\n\n      // Return user data for navigation\n      return {\n        success: true,\n        user: googleData.user\n      };\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : 'Google login failed';\n      dispatch({\n        type: AUTH_ACTIONS.LOGIN_FAILURE,\n        payload: errorMessage\n      });\n      console.error('‚ùå Google login error in AuthContext:', errorMessage);\n      return {\n        success: false,\n        error: errorMessage\n      };\n    }\n  };\n\n  // Login function with proper error handling\n  const login = async credentials => {\n    try {\n      var _data$data, _data$data2;\n      dispatch({\n        type: AUTH_ACTIONS.LOGIN_START\n      });\n      console.log('üîµ Attempting login with:', credentials.email);\n\n      // authAPI.login returns response.data directly (due to interceptor)\n      const data = await authAPI.login(credentials);\n      console.log('üîç Login response received:', {\n        success: data === null || data === void 0 ? void 0 : data.success,\n        hasData: !!(data !== null && data !== void 0 && data.data),\n        hasUser: !!(data !== null && data !== void 0 && (_data$data = data.data) !== null && _data$data !== void 0 && _data$data.user),\n        hasToken: !!(data !== null && data !== void 0 && (_data$data2 = data.data) !== null && _data$data2 !== void 0 && _data$data2.accessToken)\n      });\n      if (data && data.success && data.data) {\n        const {\n          accessToken,\n          refreshToken,\n          user\n        } = data.data;\n        console.log('‚úÖ Login successful, storing tokens...');\n\n        // Store tokens FIRST\n        setTokens(accessToken, refreshToken);\n\n        // Update state AFTER tokens are stored\n        dispatch({\n          type: AUTH_ACTIONS.LOGIN_SUCCESS,\n          payload: {\n            user\n          }\n        });\n        toast.success(`Welcome back, ${user.name}!`);\n        console.log('‚úÖ Auth state updated, returning success');\n\n        // Return user data for navigation\n        return {\n          success: true,\n          user\n        };\n      } else {\n        const errorMsg = (data === null || data === void 0 ? void 0 : data.message) || 'Invalid credentials';\n        console.error('‚ùå Login failed - invalid response:', errorMsg);\n        throw new Error(errorMsg);\n      }\n    } catch (error) {\n      var _error$response, _error$response$data;\n      console.error('‚ùå Login error caught:', error);\n\n      // Handle network errors\n      if (error.isNetworkError || error.code === 'ERR_NETWORK' || !error.response) {\n        const networkErrorMsg = 'Unable to connect to server. Please ensure the backend is running on port 5000.';\n        console.error('‚ùå Network error:', networkErrorMsg);\n        dispatch({\n          type: AUTH_ACTIONS.LOGIN_FAILURE,\n          payload: networkErrorMsg\n        });\n        return {\n          success: false,\n          error: networkErrorMsg\n        };\n      }\n\n      // Handle API errors\n      const errorMessage = ((_error$response = error.response) === null || _error$response === void 0 ? void 0 : (_error$response$data = _error$response.data) === null || _error$response$data === void 0 ? void 0 : _error$response$data.message) || error.message || 'Invalid credentials';\n      console.error('‚ùå API error:', errorMessage);\n      dispatch({\n        type: AUTH_ACTIONS.LOGIN_FAILURE,\n        payload: errorMessage\n      });\n      return {\n        success: false,\n        error: errorMessage\n      };\n    }\n  };\n\n  // Logout function with complete session cleanup\n  const logout = async () => {\n    try {\n      const {\n        refreshToken\n      } = getTokens();\n      if (refreshToken) {\n        // Call logout API to invalidate refresh token\n        await authAPI.logout();\n      }\n\n      // Revoke Google session if user logged in with Google\n      if (window.google && window.google.accounts && window.google.accounts.id) {\n        try {\n          window.google.accounts.id.disableAutoSelect();\n          console.log('‚úÖ Google session revoked');\n        } catch (error) {\n          console.warn('‚ö†Ô∏è Failed to revoke Google session:', error);\n        }\n      }\n    } catch (error) {\n      console.error('Logout API error:', error);\n    } finally {\n      // Clear tokens and update state\n      clearTokens();\n      dispatch({\n        type: AUTH_ACTIONS.LOGOUT\n      });\n\n      // Clear any cached data\n      if (window.sessionStorage) {\n        window.sessionStorage.clear();\n      }\n\n      // Show success message\n      toast.success('Logged out successfully');\n\n      // Force redirect to login page\n      window.location.href = '/login';\n    }\n  };\n\n  // Refresh token function\n  const refreshToken = async () => {\n    try {\n      const {\n        refreshToken: token\n      } = getTokens();\n      if (!token) {\n        throw new Error('No refresh token available');\n      }\n      dispatch({\n        type: AUTH_ACTIONS.REFRESH_TOKEN_START\n      });\n      const response = await authAPI.refreshToken({\n        refreshToken: token\n      });\n      const data = response.data;\n      if (data.success && data.data) {\n        const {\n          accessToken,\n          user\n        } = data.data;\n\n        // Update access token\n        localStorage.setItem('accessToken', accessToken);\n\n        // Update state\n        dispatch({\n          type: AUTH_ACTIONS.REFRESH_TOKEN_SUCCESS,\n          payload: {\n            user\n          }\n        });\n        return {\n          success: true\n        };\n      } else {\n        throw new Error(data.message || 'Token refresh failed');\n      }\n    } catch (error) {\n      var _error$response2, _error$response2$data;\n      const errorMessage = ((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message) || error.message || 'Token refresh failed';\n\n      // Clear tokens and update state\n      clearTokens();\n      dispatch({\n        type: AUTH_ACTIONS.REFRESH_TOKEN_FAILURE,\n        payload: errorMessage\n      });\n      return {\n        success: false,\n        error: errorMessage\n      };\n    }\n  };\n\n  // Load user from token\n  const loadUser = async () => {\n    try {\n      const {\n        accessToken\n      } = getTokens();\n      if (!accessToken) {\n        throw new Error('No access token available');\n      }\n      dispatch({\n        type: AUTH_ACTIONS.LOAD_USER_START\n      });\n      const response = await authAPI.verifyToken();\n      const data = response.data;\n      if (data.success && data.data) {\n        dispatch({\n          type: AUTH_ACTIONS.LOAD_USER_SUCCESS,\n          payload: data.data\n        });\n      } else {\n        throw new Error(data.message || 'Token verification failed');\n      }\n    } catch (error) {\n      var _error$response3, _error$response3$data;\n      const errorMessage = ((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : (_error$response3$data = _error$response3.data) === null || _error$response3$data === void 0 ? void 0 : _error$response3$data.message) || error.message || 'Failed to load user';\n\n      // Clear tokens and update state\n      clearTokens();\n      dispatch({\n        type: AUTH_ACTIONS.LOAD_USER_FAILURE,\n        payload: errorMessage\n      });\n    }\n  };\n\n  // Update user profile\n  const updateUser = userData => {\n    dispatch({\n      type: AUTH_ACTIONS.UPDATE_USER,\n      payload: userData\n    });\n  };\n\n  // Clear error\n  const clearError = () => {\n    dispatch({\n      type: AUTH_ACTIONS.CLEAR_ERROR\n    });\n  };\n\n  // Check if user has specific permission\n  const hasPermission = permission => {\n    return state.permissions.includes(permission);\n  };\n\n  // Check if user has any of the specified permissions\n  const hasAnyPermission = permissions => {\n    return permissions.some(permission => state.permissions.includes(permission));\n  };\n\n  // Check if user has all specified permissions\n  const hasAllPermissions = permissions => {\n    return permissions.every(permission => state.permissions.includes(permission));\n  };\n\n  // Check if user has specific role\n  const hasRole = role => {\n    var _state$user;\n    return ((_state$user = state.user) === null || _state$user === void 0 ? void 0 : _state$user.role) === role;\n  };\n\n  // Check if user has any of the specified roles\n  const hasAnyRole = roles => {\n    return state.user ? roles.includes(state.user.role) : false;\n  };\n\n  // Auto-logout on token expiry\n  useEffect(() => {\n    const {\n      accessToken\n    } = getTokens();\n    if (accessToken) {\n      try {\n        // Decode JWT token to check expiry\n        const tokenData = JSON.parse(atob(accessToken.split('.')[1]));\n        const currentTime = Date.now() / 1000;\n\n        // Auto-refresh token 5 minutes before expiry\n        const timeUntilExpiry = tokenData.exp - currentTime;\n        if (timeUntilExpiry > 0 && timeUntilExpiry < 300) {\n          refreshToken();\n        } else if (timeUntilExpiry <= 0) {\n          logout();\n        }\n      } catch (error) {\n        console.error('Token decode error:', error);\n        logout();\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [state.isAuthenticated]);\n\n  // Load user on app start\n  useEffect(() => {\n    const {\n      accessToken\n    } = getTokens();\n    if (accessToken) {\n      loadUser();\n    } else {\n      dispatch({\n        type: AUTH_ACTIONS.LOAD_USER_FAILURE,\n        payload: 'No token found'\n      });\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  const value = {\n    // State\n    ...state,\n    // Actions\n    login,\n    loginWithGoogle,\n    setAuthData,\n    logout,\n    refreshToken,\n    loadUser,\n    updateUser,\n    clearError,\n    // Permission helpers\n    hasPermission,\n    hasAnyPermission,\n    hasAllPermissions,\n    hasRole,\n    hasAnyRole\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 597,\n    columnNumber: 10\n  }, this);\n};\n\n// ==================== CUSTOM HOOK ====================\n_s(AuthProvider, \"GUSXxL/WUElrtHc/X73NyHNRMdw=\");\n_c = AuthProvider;\nexport const useAuth = () => {\n  _s2();\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n_s2(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport default AuthContext;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useContext","useReducer","useEffect","authAPI","toast","jsxDEV","_jsxDEV","AUTH_ACTIONS","LOGIN_START","LOGIN_SUCCESS","LOGIN_FAILURE","LOGOUT","REFRESH_TOKEN_START","REFRESH_TOKEN_SUCCESS","REFRESH_TOKEN_FAILURE","LOAD_USER_START","LOAD_USER_SUCCESS","LOAD_USER_FAILURE","CLEAR_ERROR","UPDATE_USER","initialState","user","isAuthenticated","isLoading","error","permissions","authReducer","state","action","type","payload","AuthContext","undefined","AuthProvider","children","_s","dispatch","getTokens","accessToken","localStorage","getItem","refreshToken","setTokens","setItem","clearTokens","removeItem","setAuthData","loginWithGoogle","googleData","console","log","success","errorMessage","Error","message","login","credentials","_data$data","_data$data2","email","data","hasData","hasUser","hasToken","name","errorMsg","_error$response","_error$response$data","isNetworkError","code","response","networkErrorMsg","logout","window","google","accounts","id","disableAutoSelect","warn","sessionStorage","clear","location","href","token","_error$response2","_error$response2$data","loadUser","verifyToken","_error$response3","_error$response3$data","updateUser","userData","clearError","hasPermission","permission","includes","hasAnyPermission","some","hasAllPermissions","every","hasRole","role","_state$user","hasAnyRole","roles","tokenData","JSON","parse","atob","split","currentTime","Date","now","timeUntilExpiry","exp","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAuth","_s2","context","$RefreshReg$"],"sources":["C:/Users/MSI/Videos/Employee-Register-App/frontend/src/contexts/AuthContext.tsx"],"sourcesContent":["/**\r\n * AuthContext - TypeScript Conversion\r\n * \r\n * CHANGES MADE:\r\n * 1. Added proper TypeScript interfaces for state, actions, and context\r\n * 2. Typed all function parameters and return values\r\n * 3. Created AuthState interface for reducer state\r\n * 4. Created AuthAction union type for all possible actions\r\n * 5. Typed reducer function with proper action types\r\n * 6. Added proper typing for context value\r\n * 7. Converted all functions to use TypeScript types\r\n * 8. Added proper error typing\r\n * \r\n * NO BEHAVIORAL CHANGES - All logic preserved exactly as-is\r\n */\r\n\r\nimport React, { createContext, useContext, useReducer, useEffect, ReactNode } from 'react';\r\nimport { authAPI } from '../services/api';\r\nimport toast from 'react-hot-toast';\r\nimport { User, LoginCredentials, AuthResponse } from '../types';\r\n\r\n// Extend Window interface for Google API\r\ndeclare global {\r\n  interface Window {\r\n    google?: {\r\n      accounts?: {\r\n        id?: {\r\n          disableAutoSelect: () => void;\r\n        };\r\n      };\r\n    };\r\n  }\r\n}\r\n\r\n// ==================== INTERFACES ====================\r\n\r\ninterface AuthState {\r\n  user: User | null;\r\n  isAuthenticated: boolean;\r\n  isLoading: boolean;\r\n  error: string | null;\r\n  permissions: string[];\r\n}\r\n\r\ninterface GoogleAuthData {\r\n  user: User;\r\n  accessToken: string;\r\n  refreshToken: string;\r\n}\r\n\r\ninterface LoginResult {\r\n  success: boolean;\r\n  user?: User;\r\n  error?: string;\r\n}\r\n\r\ninterface TokenRefreshResult {\r\n  success: boolean;\r\n  error?: string;\r\n}\r\n\r\ninterface AuthContextValue extends AuthState {\r\n  login: (credentials: LoginCredentials) => Promise<LoginResult>;\r\n  loginWithGoogle: (googleData: GoogleAuthData) => Promise<LoginResult>;\r\n  setAuthData: (data: GoogleAuthData) => void;\r\n  logout: () => Promise<void>;\r\n  refreshToken: () => Promise<TokenRefreshResult>;\r\n  loadUser: () => Promise<void>;\r\n  updateUser: (userData: Partial<User>) => void;\r\n  clearError: () => void;\r\n  hasPermission: (permission: string) => boolean;\r\n  hasAnyPermission: (permissions: string[]) => boolean;\r\n  hasAllPermissions: (permissions: string[]) => boolean;\r\n  hasRole: (role: string) => boolean;\r\n  hasAnyRole: (roles: string[]) => boolean;\r\n}\r\n\r\n// ==================== ACTION TYPES ====================\r\n\r\nconst AUTH_ACTIONS = {\r\n  LOGIN_START: 'LOGIN_START',\r\n  LOGIN_SUCCESS: 'LOGIN_SUCCESS',\r\n  LOGIN_FAILURE: 'LOGIN_FAILURE',\r\n  LOGOUT: 'LOGOUT',\r\n  REFRESH_TOKEN_START: 'REFRESH_TOKEN_START',\r\n  REFRESH_TOKEN_SUCCESS: 'REFRESH_TOKEN_SUCCESS',\r\n  REFRESH_TOKEN_FAILURE: 'REFRESH_TOKEN_FAILURE',\r\n  LOAD_USER_START: 'LOAD_USER_START',\r\n  LOAD_USER_SUCCESS: 'LOAD_USER_SUCCESS',\r\n  LOAD_USER_FAILURE: 'LOAD_USER_FAILURE',\r\n  CLEAR_ERROR: 'CLEAR_ERROR',\r\n  UPDATE_USER: 'UPDATE_USER',\r\n} as const;\r\n\r\n// Union type for all possible actions\r\ntype AuthAction =\r\n  | { type: 'LOGIN_START' }\r\n  | { type: 'LOGIN_SUCCESS'; payload: { user: User } }\r\n  | { type: 'LOGIN_FAILURE'; payload: string }\r\n  | { type: 'LOGOUT' }\r\n  | { type: 'REFRESH_TOKEN_START' }\r\n  | { type: 'REFRESH_TOKEN_SUCCESS'; payload: { user: User } }\r\n  | { type: 'REFRESH_TOKEN_FAILURE'; payload: string }\r\n  | { type: 'LOAD_USER_START' }\r\n  | { type: 'LOAD_USER_SUCCESS'; payload: { user: User } }\r\n  | { type: 'LOAD_USER_FAILURE'; payload: string }\r\n  | { type: 'CLEAR_ERROR' }\r\n  | { type: 'UPDATE_USER'; payload: Partial<User> };\r\n\r\n// ==================== INITIAL STATE ====================\r\n\r\nconst initialState: AuthState = {\r\n  user: null,\r\n  isAuthenticated: false,\r\n  isLoading: true,\r\n  error: null,\r\n  permissions: [],\r\n};\r\n\r\n// ==================== REDUCER ====================\r\n\r\nconst authReducer = (state: AuthState, action: AuthAction): AuthState => {\r\n  switch (action.type) {\r\n    case AUTH_ACTIONS.LOGIN_START:\r\n      return {\r\n        ...state,\r\n        isLoading: true,\r\n        error: null,\r\n      };\r\n\r\n    case AUTH_ACTIONS.LOGIN_SUCCESS:\r\n      return {\r\n        ...state,\r\n        user: action.payload.user,\r\n        isAuthenticated: true,\r\n        isLoading: false,\r\n        error: null,\r\n        permissions: action.payload.user.permissions || [],\r\n      };\r\n\r\n    case AUTH_ACTIONS.LOGIN_FAILURE:\r\n      return {\r\n        ...state,\r\n        user: null,\r\n        isAuthenticated: false,\r\n        isLoading: false,\r\n        error: action.payload,\r\n        permissions: [],\r\n      };\r\n\r\n    case AUTH_ACTIONS.LOGOUT:\r\n      return {\r\n        ...state,\r\n        user: null,\r\n        isAuthenticated: false,\r\n        isLoading: false,\r\n        error: null,\r\n        permissions: [],\r\n      };\r\n\r\n    case AUTH_ACTIONS.REFRESH_TOKEN_START:\r\n      return {\r\n        ...state,\r\n        isLoading: true,\r\n      };\r\n\r\n    case AUTH_ACTIONS.REFRESH_TOKEN_SUCCESS:\r\n      return {\r\n        ...state,\r\n        user: action.payload.user,\r\n        isAuthenticated: true,\r\n        isLoading: false,\r\n        error: null,\r\n        permissions: action.payload.user.permissions || [],\r\n      };\r\n\r\n    case AUTH_ACTIONS.REFRESH_TOKEN_FAILURE:\r\n      return {\r\n        ...state,\r\n        user: null,\r\n        isAuthenticated: false,\r\n        isLoading: false,\r\n        error: action.payload,\r\n        permissions: [],\r\n      };\r\n\r\n    case AUTH_ACTIONS.LOAD_USER_START:\r\n      return {\r\n        ...state,\r\n        isLoading: true,\r\n      };\r\n\r\n    case AUTH_ACTIONS.LOAD_USER_SUCCESS:\r\n      return {\r\n        ...state,\r\n        user: action.payload.user,\r\n        isAuthenticated: true,\r\n        isLoading: false,\r\n        error: null,\r\n        permissions: action.payload.user.permissions || [],\r\n      };\r\n\r\n    case AUTH_ACTIONS.LOAD_USER_FAILURE:\r\n      return {\r\n        ...state,\r\n        user: null,\r\n        isAuthenticated: false,\r\n        isLoading: false,\r\n        error: action.payload,\r\n        permissions: [],\r\n      };\r\n\r\n    case AUTH_ACTIONS.CLEAR_ERROR:\r\n      return {\r\n        ...state,\r\n        error: null,\r\n      };\r\n\r\n    case AUTH_ACTIONS.UPDATE_USER:\r\n      return {\r\n        ...state,\r\n        user: state.user ? { ...state.user, ...action.payload } : null,\r\n      };\r\n\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\n// ==================== CONTEXT ====================\r\n\r\nconst AuthContext = createContext<AuthContextValue | undefined>(undefined);\r\n\r\n// ==================== PROVIDER ====================\r\n\r\ninterface AuthProviderProps {\r\n  children: ReactNode;\r\n}\r\n\r\nexport const AuthProvider: React.FC<AuthProviderProps> = ({ children }) => {\r\n  const [state, dispatch] = useReducer(authReducer, initialState);\r\n\r\n  // Get tokens from localStorage\r\n  const getTokens = (): { accessToken: string | null; refreshToken: string | null } => {\r\n    const accessToken = localStorage.getItem('accessToken');\r\n    const refreshToken = localStorage.getItem('refreshToken');\r\n    return { accessToken, refreshToken };\r\n  };\r\n\r\n  // Set tokens to localStorage\r\n  const setTokens = (accessToken: string, refreshToken: string): void => {\r\n    localStorage.setItem('accessToken', accessToken);\r\n    localStorage.setItem('refreshToken', refreshToken);\r\n  };\r\n\r\n  // Clear tokens from localStorage\r\n  const clearTokens = (): void => {\r\n    localStorage.removeItem('accessToken');\r\n    localStorage.removeItem('refreshToken');\r\n  };\r\n\r\n  // Set auth data (for OAuth callbacks)\r\n  const setAuthData = ({ user, accessToken, refreshToken }: GoogleAuthData): void => {\r\n    setTokens(accessToken, refreshToken);\r\n    dispatch({\r\n      type: AUTH_ACTIONS.LOGIN_SUCCESS,\r\n      payload: { user },\r\n    });\r\n  };\r\n\r\n  // Google OAuth login\r\n  const loginWithGoogle = async (googleData: GoogleAuthData): Promise<LoginResult> => {\r\n    try {\r\n      dispatch({ type: AUTH_ACTIONS.LOGIN_START });\r\n\r\n      // Store access token in localStorage FIRST\r\n      if (googleData.accessToken) {\r\n        localStorage.setItem('accessToken', googleData.accessToken);\r\n      }\r\n      \r\n      // Store refresh token if available\r\n      if (googleData.refreshToken) {\r\n        localStorage.setItem('refreshToken', googleData.refreshToken);\r\n      }\r\n      \r\n      // Update state with user data AFTER tokens are stored\r\n      dispatch({\r\n        type: AUTH_ACTIONS.LOGIN_SUCCESS,\r\n        payload: { user: googleData.user },\r\n      });\r\n\r\n      console.log('‚úÖ Google login successful in AuthContext');\r\n      \r\n      // Return user data for navigation\r\n      return { success: true, user: googleData.user };\r\n    } catch (error) {\r\n      const errorMessage = error instanceof Error ? error.message : 'Google login failed';\r\n      \r\n      dispatch({\r\n        type: AUTH_ACTIONS.LOGIN_FAILURE,\r\n        payload: errorMessage,\r\n      });\r\n\r\n      console.error('‚ùå Google login error in AuthContext:', errorMessage);\r\n      \r\n      return { success: false, error: errorMessage };\r\n    }\r\n  };\r\n\r\n  // Login function with proper error handling\r\n  const login = async (credentials: LoginCredentials): Promise<LoginResult> => {\r\n    try {\r\n      dispatch({ type: AUTH_ACTIONS.LOGIN_START });\r\n\r\n      console.log('üîµ Attempting login with:', credentials.email);\r\n\r\n      // authAPI.login returns response.data directly (due to interceptor)\r\n      const data = await authAPI.login(credentials) as any;\r\n      \r\n      console.log('üîç Login response received:', { \r\n        success: data?.success, \r\n        hasData: !!data?.data,\r\n        hasUser: !!data?.data?.user,\r\n        hasToken: !!data?.data?.accessToken\r\n      });\r\n      \r\n      if (data && data.success && data.data) {\r\n        const { accessToken, refreshToken, user } = data.data;\r\n        \r\n        console.log('‚úÖ Login successful, storing tokens...');\r\n        \r\n        // Store tokens FIRST\r\n        setTokens(accessToken, refreshToken);\r\n        \r\n        // Update state AFTER tokens are stored\r\n        dispatch({\r\n          type: AUTH_ACTIONS.LOGIN_SUCCESS,\r\n          payload: { user },\r\n        });\r\n\r\n        toast.success(`Welcome back, ${user.name}!`);\r\n        \r\n        console.log('‚úÖ Auth state updated, returning success');\r\n        \r\n        // Return user data for navigation\r\n        return { success: true, user };\r\n      } else {\r\n        const errorMsg = data?.message || 'Invalid credentials';\r\n        console.error('‚ùå Login failed - invalid response:', errorMsg);\r\n        throw new Error(errorMsg);\r\n      }\r\n    } catch (error: any) {\r\n      console.error('‚ùå Login error caught:', error);\r\n      \r\n      // Handle network errors\r\n      if (error.isNetworkError || error.code === 'ERR_NETWORK' || !error.response) {\r\n        const networkErrorMsg = 'Unable to connect to server. Please ensure the backend is running on port 5000.';\r\n        console.error('‚ùå Network error:', networkErrorMsg);\r\n        \r\n        dispatch({\r\n          type: AUTH_ACTIONS.LOGIN_FAILURE,\r\n          payload: networkErrorMsg,\r\n        });\r\n        \r\n        return { success: false, error: networkErrorMsg };\r\n      }\r\n      \r\n      // Handle API errors\r\n      const errorMessage = error.response?.data?.message || error.message || 'Invalid credentials';\r\n      \r\n      console.error('‚ùå API error:', errorMessage);\r\n      \r\n      dispatch({\r\n        type: AUTH_ACTIONS.LOGIN_FAILURE,\r\n        payload: errorMessage,\r\n      });\r\n      \r\n      return { success: false, error: errorMessage };\r\n    }\r\n  };\r\n\r\n  // Logout function with complete session cleanup\r\n  const logout = async (): Promise<void> => {\r\n    try {\r\n      const { refreshToken } = getTokens();\r\n      \r\n      if (refreshToken) {\r\n        // Call logout API to invalidate refresh token\r\n        await authAPI.logout();\r\n      }\r\n\r\n      // Revoke Google session if user logged in with Google\r\n      if (window.google && window.google.accounts && window.google.accounts.id) {\r\n        try {\r\n          window.google.accounts.id.disableAutoSelect();\r\n          console.log('‚úÖ Google session revoked');\r\n        } catch (error) {\r\n          console.warn('‚ö†Ô∏è Failed to revoke Google session:', error);\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error('Logout API error:', error);\r\n    } finally {\r\n      // Clear tokens and update state\r\n      clearTokens();\r\n      dispatch({ type: AUTH_ACTIONS.LOGOUT });\r\n      \r\n      // Clear any cached data\r\n      if (window.sessionStorage) {\r\n        window.sessionStorage.clear();\r\n      }\r\n      \r\n      // Show success message\r\n      toast.success('Logged out successfully');\r\n      \r\n      // Force redirect to login page\r\n      window.location.href = '/login';\r\n    }\r\n  };\r\n\r\n  // Refresh token function\r\n  const refreshToken = async (): Promise<TokenRefreshResult> => {\r\n    try {\r\n      const { refreshToken: token } = getTokens();\r\n      \r\n      if (!token) {\r\n        throw new Error('No refresh token available');\r\n      }\r\n\r\n      dispatch({ type: AUTH_ACTIONS.REFRESH_TOKEN_START });\r\n\r\n      const response = await authAPI.refreshToken({ refreshToken: token });\r\n      const data: AuthResponse = response.data;\r\n      \r\n      if (data.success && data.data) {\r\n        const { accessToken, user } = data.data;\r\n        \r\n        // Update access token\r\n        localStorage.setItem('accessToken', accessToken);\r\n        \r\n        // Update state\r\n        dispatch({\r\n          type: AUTH_ACTIONS.REFRESH_TOKEN_SUCCESS,\r\n          payload: { user },\r\n        });\r\n\r\n        return { success: true };\r\n      } else {\r\n        throw new Error(data.message || 'Token refresh failed');\r\n      }\r\n    } catch (error: any) {\r\n      const errorMessage = error.response?.data?.message || error.message || 'Token refresh failed';\r\n      \r\n      // Clear tokens and update state\r\n      clearTokens();\r\n      dispatch({\r\n        type: AUTH_ACTIONS.REFRESH_TOKEN_FAILURE,\r\n        payload: errorMessage,\r\n      });\r\n\r\n      return { success: false, error: errorMessage };\r\n    }\r\n  };\r\n\r\n  // Load user from token\r\n  const loadUser = async (): Promise<void> => {\r\n    try {\r\n      const { accessToken } = getTokens();\r\n      \r\n      if (!accessToken) {\r\n        throw new Error('No access token available');\r\n      }\r\n\r\n      dispatch({ type: AUTH_ACTIONS.LOAD_USER_START });\r\n\r\n      const response = await authAPI.verifyToken();\r\n      const data: AuthResponse = response.data;\r\n      \r\n      if (data.success && data.data) {\r\n        dispatch({\r\n          type: AUTH_ACTIONS.LOAD_USER_SUCCESS,\r\n          payload: data.data,\r\n        });\r\n      } else {\r\n        throw new Error(data.message || 'Token verification failed');\r\n      }\r\n    } catch (error: any) {\r\n      const errorMessage = error.response?.data?.message || error.message || 'Failed to load user';\r\n      \r\n      // Clear tokens and update state\r\n      clearTokens();\r\n      dispatch({\r\n        type: AUTH_ACTIONS.LOAD_USER_FAILURE,\r\n        payload: errorMessage,\r\n      });\r\n    }\r\n  };\r\n\r\n  // Update user profile\r\n  const updateUser = (userData: Partial<User>): void => {\r\n    dispatch({\r\n      type: AUTH_ACTIONS.UPDATE_USER,\r\n      payload: userData,\r\n    });\r\n  };\r\n\r\n  // Clear error\r\n  const clearError = (): void => {\r\n    dispatch({ type: AUTH_ACTIONS.CLEAR_ERROR });\r\n  };\r\n\r\n  // Check if user has specific permission\r\n  const hasPermission = (permission: string): boolean => {\r\n    return state.permissions.includes(permission);\r\n  };\r\n\r\n  // Check if user has any of the specified permissions\r\n  const hasAnyPermission = (permissions: string[]): boolean => {\r\n    return permissions.some(permission => state.permissions.includes(permission));\r\n  };\r\n\r\n  // Check if user has all specified permissions\r\n  const hasAllPermissions = (permissions: string[]): boolean => {\r\n    return permissions.every(permission => state.permissions.includes(permission));\r\n  };\r\n\r\n  // Check if user has specific role\r\n  const hasRole = (role: string): boolean => {\r\n    return state.user?.role === role;\r\n  };\r\n\r\n  // Check if user has any of the specified roles\r\n  const hasAnyRole = (roles: string[]): boolean => {\r\n    return state.user ? roles.includes(state.user.role) : false;\r\n  };\r\n\r\n  // Auto-logout on token expiry\r\n  useEffect(() => {\r\n    const { accessToken } = getTokens();\r\n    \r\n    if (accessToken) {\r\n      try {\r\n        // Decode JWT token to check expiry\r\n        const tokenData = JSON.parse(atob(accessToken.split('.')[1]));\r\n        const currentTime = Date.now() / 1000;\r\n        \r\n        // Auto-refresh token 5 minutes before expiry\r\n        const timeUntilExpiry = tokenData.exp - currentTime;\r\n        \r\n        if (timeUntilExpiry > 0 && timeUntilExpiry < 300) {\r\n          refreshToken();\r\n        } else if (timeUntilExpiry <= 0) {\r\n          logout();\r\n        }\r\n      } catch (error) {\r\n        console.error('Token decode error:', error);\r\n        logout();\r\n      }\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [state.isAuthenticated]);\r\n\r\n  // Load user on app start\r\n  useEffect(() => {\r\n    const { accessToken } = getTokens();\r\n    \r\n    if (accessToken) {\r\n      loadUser();\r\n    } else {\r\n      dispatch({ type: AUTH_ACTIONS.LOAD_USER_FAILURE, payload: 'No token found' });\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []);\r\n\r\n  const value: AuthContextValue = {\r\n    // State\r\n    ...state,\r\n    \r\n    // Actions\r\n    login,\r\n    loginWithGoogle,\r\n    setAuthData,\r\n    logout,\r\n    refreshToken,\r\n    loadUser,\r\n    updateUser,\r\n    clearError,\r\n    \r\n    // Permission helpers\r\n    hasPermission,\r\n    hasAnyPermission,\r\n    hasAllPermissions,\r\n    hasRole,\r\n    hasAnyRole,\r\n  };\r\n\r\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\r\n};\r\n\r\n// ==================== CUSTOM HOOK ====================\r\n\r\nexport const useAuth = (): AuthContextValue => {\r\n  const context = useContext(AuthContext);\r\n  \r\n  if (!context) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  \r\n  return context;\r\n};\r\n\r\nexport default AuthContext;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}